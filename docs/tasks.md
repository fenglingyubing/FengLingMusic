# FLMusic 音乐软件开发任务文档

## 文档版本
- **版本**: v1.0
- **创建日期**: 2026-01-20
- **最后更新**: 2026-01-20
- **状态**: 规划中

---

## 目录
1. [项目概述](#1-项目概述)
2. [开发阶段规划](#2-开发阶段规划)
3. [任务优先级定义](#3-任务优先级定义)
4. [详细任务列表](#4-详细任务列表)
5. [里程碑计划](#5-里程碑计划)
6. [风险管理](#6-风险管理)
7. [资源分配](#7-资源分配)

---

## 1. 项目概述

### 1.1 项目目标
开发一款支持 Windows 和 Android 双平台的现代化音乐播放器，具备本地播放、在线搜索、歌词显示等功能，并实现 120fps 流畅动画体验。

### 1.2 开发周期
预计总工期：**20-30 周**（5 个阶段）

### 1.3 技术栈
- **框架**: Flutter 3.x
- **状态管理**: Riverpod 2.x
- **音频**: just_audio + audio_service
- **数据库**: SQLite + Hive
- **动画**: Flutter Animations + flutter_animate + rive

---

## 2. 开发阶段规划

```
阶段一：项目基础搭建 + MVP (4-6周)
  └─> 阶段二：核心功能完善 (4-6周)
       └─> 阶段三：在线功能 (6-8周)
            └─> 阶段四：优化和平台特性 (4-6周)
                 └─> 阶段五：测试和发布 (2-4周)
```

---

## 3. 任务优先级定义

| 优先级 | 标识 | 说明 | 处理原则 |
|--------|------|------|----------|
| P0 | 🔴 | 核心功能，阻塞性任务 | 必须完成 |
| P1 | 🟠 | 重要功能，影响体验 | 优先完成 |
| P2 | 🟡 | 常规功能 | 按计划完成 |
| P3 | 🟢 | 优化和增强 | 时间允许时完成 |

---

## 4. 详细任务列表

## 阶段一：项目基础搭建 + MVP（4-6 周）

### 📋 里程碑目标
实现基础播放功能，能够扫描本地音乐并播放

---

### 4.1 项目初始化（第 1 周）

#### 4.1.1 环境搭建 🔴 P0
- [ ] **TASK-001**: 安装 Flutter 3.16+ SDK
  - **预计工时**: 0.5 天
  - **负责人**: 开发组长
  - **验收标准**: `flutter doctor` 无错误
  - **依赖**: 无

- [ ] **TASK-002**: 配置开发 IDE（VS Code / Android Studio）
  - **预计工时**: 0.5 天
  - **依赖**: TASK-001
  - **验收标准**:
    - Flutter 插件安装完成
    - Dart 代码格式化配置完成
    - 调试环境正常

- [ ] **TASK-003**: 创建 Flutter 项目
  - **预计工时**: 0.5 天
  - **依赖**: TASK-002
  - **验收标准**:
    - 项目创建成功
    - 支持 Windows 和 Android 平台
    - 示例程序能正常运行

#### 4.1.2 项目结构搭建 🔴 P0
- [ ] **TASK-004**: 创建目录结构
  - **预计工时**: 1 天
  - **依赖**: TASK-003
  - **验收标准**: 按设计文档创建完整目录结构
  - **详细内容**:
    ```
    lib/
    ├── core/
    ├── data/
    ├── domain/
    ├── presentation/
    └── services/
    ```

- [ ] **TASK-005**: 配置项目依赖
  - **预计工时**: 1 天
  - **依赖**: TASK-004
  - **验收标准**: pubspec.yaml 配置完成
  - **依赖包列表**:
    ```yaml
    dependencies:
      flutter_riverpod: ^2.4.0
      riverpod_annotation: ^2.3.0
      just_audio: ^0.9.36
      audio_service: ^0.18.12
      sqflite: ^2.3.0
      hive: ^2.2.3
      hive_flutter: ^1.1.0
      dio: ^5.4.0
      path_provider: ^2.1.1
      animations: ^2.0.8
      flutter_animate: ^4.3.0
    ```

- [ ] **TASK-006**: 配置代码生成工具
  - **预计工时**: 0.5 天
  - **依赖**: TASK-005
  - **验收标准**:
    - build_runner 配置完成
    - 代码生成脚本可执行
    - freezed、json_serializable 正常工作

#### 4.1.3 核心配置 🔴 P0
- [ ] **TASK-007**: 创建应用主题
  - **预计工时**: 2 天
  - **依赖**: TASK-005
  - **验收标准**:
    - 浅色主题实现
    - 深色主题实现
    - 主题切换功能
    - 符合设计规范

- [ ] **TASK-008**: 配置路由系统
  - **预计工时**: 1 天
  - **依赖**: TASK-004
  - **验收标准**:
    - 路由配置完成
    - 页面导航正常
    - 支持参数传递

- [ ] **TASK-009**: 设置全局常量
  - **预计工时**: 0.5 天
  - **依赖**: TASK-004
  - **验收标准**:
    - 动画常量（120fps 相关）
    - 应用常量
    - 路由常量

---

### 4.2 数据层实现（第 2-3 周）

#### 4.2.1 数据库设计实现 🔴 P0
- [ ] **TASK-010**: 实现 SQLite 数据库帮助类
  - **预计工时**: 2 天
  - **依赖**: TASK-005
  - **验收标准**:
    - 数据库初始化
    - 版本管理
    - 升级策略
  - **文件**: `lib/data/datasources/local/database_helper.dart`

- [ ] **TASK-011**: 创建数据库表结构
  - **预计工时**: 3 天
  - **依赖**: TASK-010
  - **验收标准**: 按设计文档创建 8 张表
  - **表列表**:
    - Songs 表
    - Playlists 表
    - PlaylistSongs 表
    - PlayHistory 表
    - Artists 表
    - Albums 表
    - Settings 表
    - DownloadQueue 表

- [ ] **TASK-012**: 创建索引和优化
  - **预计工时**: 1 天
  - **依赖**: TASK-011
  - **验收标准**:
    - 为常用查询字段创建索引
    - 外键约束配置
    - 查询性能测试通过

#### 4.2.2 数据模型实现 🔴 P0
- [ ] **TASK-013**: 实现 Song 数据模型
  - **预计工时**: 1 天
  - **依赖**: TASK-005
  - **验收标准**:
    - 使用 freezed 生成不可变类
    - JSON 序列化/反序列化
    - copyWith 方法
  - **文件**: `lib/data/models/song_model.dart`

- [ ] **TASK-014**: 实现 Playlist 数据模型
  - **预计工时**: 1 天
  - **依赖**: TASK-013
  - **文件**: `lib/data/models/playlist_model.dart`

- [ ] **TASK-015**: 实现其他数据模型
  - **预计工时**: 2 天
  - **依赖**: TASK-014
  - **模型列表**:
    - Artist
    - Album
    - PlayHistory
    - DownloadItem
    - LyricLine

#### 4.2.3 数据访问层（DAO）🔴 P0
- [ ] **TASK-016**: 实现 SongDAO
  - **预计工时**: 3 天
  - **依赖**: TASK-011, TASK-013
  - **验收标准**:
    - CRUD 操作
    - 批量操作
    - 复杂查询（按艺术家、专辑、搜索等）
  - **文件**: `lib/data/datasources/local/song_dao.dart`

- [ ] **TASK-017**: 实现 PlaylistDAO
  - **预计工时**: 2 天
  - **依赖**: TASK-016
  - **文件**: `lib/data/datasources/local/playlist_dao.dart`

- [ ] **TASK-018**: 实现 PlayHistoryDAO
  - **预计工时**: 1 天
  - **依赖**: TASK-016
  - **文件**: `lib/data/datasources/local/play_history_dao.dart`

#### 4.2.4 Hive 本地存储 🟠 P1
- [ ] **TASK-019**: 实现 Hive 初始化
  - **预计工时**: 0.5 天
  - **依赖**: TASK-005
  - **验收标准**: Hive 初始化成功

- [ ] **TASK-020**: 实现用户设置存储
  - **预计工时**: 1 天
  - **依赖**: TASK-019
  - **验收标准**:
    - UserSettings 类型适配器
    - 读写操作
    - 默认值处理

- [ ] **TASK-021**: 实现播放器状态缓存
  - **预计工时**: 1 天
  - **依赖**: TASK-019
  - **验收标准**: 播放状态持久化

#### 4.2.5 仓库层实现 🔴 P0
- [ ] **TASK-022**: 实现 SongRepository
  - **预计工时**: 2 天
  - **依赖**: TASK-016
  - **验收标准**: 封装数据源，提供业务接口
  - **文件**: `lib/data/repositories/song_repository_impl.dart`

- [ ] **TASK-023**: 实现 PlaylistRepository
  - **预计工时**: 2 天
  - **依赖**: TASK-017
  - **文件**: `lib/data/repositories/playlist_repository_impl.dart`

---

### 4.3 音频播放模块（第 3-4 周）

#### 4.3.1 音频服务实现 🔴 P0
- [ ] **TASK-024**: 实现 AudioPlayerService 接口
  - **预计工时**: 1 天
  - **依赖**: TASK-005
  - **验收标准**: 定义播放服务接口
  - **文件**: `lib/services/audio/audio_player_service.dart`

- [ ] **TASK-025**: 实现基础播放功能
  - **预计工时**: 3 天
  - **依赖**: TASK-024
  - **验收标准**:
    - 播放/暂停
    - 停止
    - 跳转位置
    - 音量控制
  - **文件**: `lib/services/audio/audio_player_service_impl.dart`

- [ ] **TASK-026**: 实现播放队列管理
  - **预计工时**: 2 天
  - **依赖**: TASK-025
  - **验收标准**:
    - 队列添加/删除
    - 上一曲/下一曲
    - 播放模式（顺序、随机、单曲循环）

- [ ] **TASK-027**: 实现播放状态管理
  - **预计工时**: 2 天
  - **依赖**: TASK-025
  - **验收标准**:
    - 播放状态流（Stream）
    - 进度流
    - 时长流
    - 当前歌曲流

#### 4.3.2 音频效果 🟡 P2
- [ ] **TASK-028**: 实现淡入淡出效果
  - **预计工时**: 1 天
  - **依赖**: TASK-025
  - **验收标准**: 切歌时平滑过渡

- [ ] **TASK-029**: 实现音量正常化
  - **预计工时**: 1 天
  - **依赖**: TASK-025
  - **验收标准**: 不同歌曲音量统一

---

### 4.4 音乐库管理（第 4 周）

#### 4.4.1 文件扫描器 🔴 P0
- [ ] **TASK-030**: 实现文件系统遍历
  - **预计工时**: 2 天
  - **依赖**: TASK-022
  - **验收标准**:
    - 递归扫描目录
    - 支持的格式过滤
    - 进度回调
  - **文件**: `lib/services/storage/music_scanner.dart`

- [ ] **TASK-031**: 实现音频元数据提取
  - **预计工时**: 2 天
  - **依赖**: TASK-030
  - **验收标准**:
    - 读取 ID3 标签
    - 提取封面图片
    - 获取音频属性（时长、码率等）

- [ ] **TASK-032**: 实现扫描结果处理
  - **预计工时**: 1 天
  - **依赖**: TASK-031
  - **验收标准**:
    - 批量插入数据库
    - 去重处理
    - 错误处理和日志

#### 4.4.2 播放列表管理 🟠 P1
- [ ] **TASK-033**: 实现播放列表创建/删除
  - **预计工时**: 1 天
  - **依赖**: TASK-023
  - **验收标准**: 基本 CRUD 操作

- [ ] **TASK-034**: 实现播放列表歌曲管理
  - **预计工时**: 2 天
  - **依赖**: TASK-033
  - **验收标准**:
    - 添加/删除歌曲
    - 重新排序
    - 批量操作

---

### 4.5 基础 UI 实现（第 5-6 周）

#### 4.5.1 主页面框架 🔴 P0
- [ ] **TASK-035**: 实现主页面布局
  - **预计工时**: 2 天
  - **依赖**: TASK-007, TASK-008
  - **验收标准**:
    - 侧边栏导航
    - 主内容区
    - 底部播放控制栏
  - **文件**: `lib/presentation/pages/home/home_page.dart`

- [ ] **TASK-036**: 实现侧边栏导航
  - **预计工时**: 1 天
  - **依赖**: TASK-035
  - **验收标准**:
    - 导航菜单
    - 图标和文字
    - 选中状态

#### 4.5.2 歌曲列表页面 🔴 P0
- [ ] **TASK-037**: 实现歌曲列表 Widget
  - **预计工时**: 3 天
  - **依赖**: TASK-035
  - **验收标准**:
    - 使用 ListView.builder
    - 显示歌曲信息
    - 封面缩略图
    - 点击播放
  - **文件**: `lib/presentation/pages/library/library_page.dart`

- [ ] **TASK-038**: 实现歌曲列表项组件
  - **预计工时**: 2 天
  - **依赖**: TASK-037
  - **验收标准**:
    - 歌曲信息显示
    - 长按菜单
    - 滑动操作
  - **文件**: `lib/presentation/widgets/song_tile.dart`

#### 4.5.3 播放器控制栏 🔴 P0
- [ ] **TASK-039**: 实现底部播放控制栏
  - **预计工时**: 3 天
  - **依赖**: TASK-027
  - **验收标准**:
    - 播放/暂停按钮
    - 上一曲/下一曲按钮
    - 进度条
    - 当前播放歌曲信息
  - **文件**: `lib/presentation/widgets/player_bar.dart`

- [ ] **TASK-040**: 实现进度条组件
  - **预计工时**: 2 天
  - **依赖**: TASK-039
  - **验收标准**:
    - 拖动跳转
    - 实时更新
    - 120fps 流畅滑动

#### 4.5.4 状态管理 🔴 P0
- [ ] **TASK-041**: 实现播放器状态 Provider
  - **预计工时**: 2 天
  - **依赖**: TASK-027
  - **验收标准**:
    - 使用 Riverpod
    - 播放状态管理
    - UI 自动更新
  - **文件**: `lib/presentation/providers/player_provider.dart`

- [ ] **TASK-042**: 实现歌曲列表 Provider
  - **预计工时**: 1 天
  - **依赖**: TASK-022
  - **文件**: `lib/presentation/providers/song_list_provider.dart`

---

### 4.6 基础动画实现 🟠 P1（第 6 周）

- [ ] **TASK-043**: 配置 120fps 支持
  - **预计工时**: 1 天
  - **依赖**: TASK-009
  - **验收标准**:
    - 刷新率检测
    - 自动适配
    - 性能监控
  - **文件**: `lib/core/animation/refresh_rate_detector.dart`

- [ ] **TASK-044**: 实现页面过渡动画
  - **预计工时**: 2 天
  - **依赖**: TASK-043
  - **验收标准**:
    - 滑动动画
    - 淡入淡出
    - 120fps 流畅
  - **文件**: `lib/presentation/animations/page_transitions.dart`

- [ ] **TASK-045**: 实现列表滚动优化
  - **预计工时**: 2 天
  - **依赖**: TASK-037
  - **验收标准**:
    - 120fps 滚动
    - 无掉帧
    - RepaintBoundary 优化

---

### ✅ 阶段一验收标准

- [ ] 能够扫描本地音乐文件
- [ ] 能够显示歌曲列表
- [ ] 能够播放/暂停音乐
- [ ] 能够切换上一曲/下一曲
- [ ] 进度条可拖动跳转
- [ ] 界面流畅，120fps 无掉帧
- [ ] 支持 Windows 和 Android 运行

---

## 阶段二：核心功能完善（4-6 周）

### 📋 里程碑目标
完善音乐管理功能，提升用户体验

---

### 4.7 播放列表功能（第 7-8 周）

#### 4.7.1 播放列表 UI 🔴 P0
- [ ] **TASK-046**: 实现播放列表页面
  - **预计工时**: 2 天
  - **依赖**: TASK-023
  - **验收标准**:
    - 显示所有播放列表
    - 创建新播放列表
    - 删除播放列表
  - **文件**: `lib/presentation/pages/playlist/playlist_page.dart`

- [ ] **TASK-047**: 实现播放列表详情页
  - **预计工时**: 2 天
  - **依赖**: TASK-046
  - **验收标准**:
    - 显示播放列表歌曲
    - 播放全部
    - 编辑模式

- [ ] **TASK-048**: 实现播放列表编辑功能
  - **预计工时**: 3 天
  - **依赖**: TASK-047
  - **验收标准**:
    - 添加/删除歌曲
    - 拖拽排序
    - 批量操作

#### 4.7.2 播放列表高级功能 🟠 P1
- [ ] **TASK-049**: 实现播放列表导出（M3U）
  - **预计工时**: 1 天
  - **依赖**: TASK-034
  - **验收标准**: 导出为 M3U/M3U8 格式

- [ ] **TASK-050**: 实现播放列表导入
  - **预计工时**: 2 天
  - **依赖**: TASK-049
  - **验收标准**: 支持导入 M3U/M3U8

---

### 4.8 音乐分类管理（第 8-9 周）

#### 4.8.1 艺术家视图 🟠 P1
- [ ] **TASK-051**: 实现艺术家列表页面
  - **预计工时**: 2 天
  - **依赖**: TASK-016
  - **验收标准**:
    - 显示所有艺术家
    - 头像/封面
    - 歌曲数量统计

- [ ] **TASK-052**: 实现艺术家详情页
  - **预计工时**: 2 天
  - **依赖**: TASK-051
  - **验收标准**:
    - 显示艺术家的所有歌曲
    - 显示艺术家的专辑
    - 播放全部

#### 4.8.2 专辑视图 🟠 P1
- [ ] **TASK-053**: 实现专辑列表页面
  - **预计工时**: 2 天
  - **依赖**: TASK-016
  - **验收标准**:
    - 网格布局显示专辑
    - 封面图片
    - 专辑信息

- [ ] **TASK-054**: 实现专辑详情页
  - **预计工时**: 2 天
  - **依赖**: TASK-053
  - **验收标准**:
    - 显示专辑的所有歌曲
    - 按音轨号排序
    - 播放全部

#### 4.8.3 文件夹视图 🟡 P2
- [ ] **TASK-055**: 实现文件夹浏览
  - **预计工时**: 3 天
  - **依赖**: TASK-016
  - **验收标准**:
    - 按文件夹结构显示
    - 面包屑导航
    - 播放文件夹内所有歌曲

---

### 4.9 收藏和历史（第 9 周）

#### 4.9.1 收藏功能 🟠 P1
- [ ] **TASK-056**: 实现歌曲收藏/取消收藏
  - **预计工时**: 1 天
  - **依赖**: TASK-016
  - **验收标准**:
    - 收藏按钮
    - 动画反馈
    - 数据库更新

- [ ] **TASK-057**: 实现收藏列表页面
  - **预计工时**: 1 天
  - **依赖**: TASK-056
  - **验收标准**: 显示所有收藏的歌曲

#### 4.9.2 播放历史 🟠 P1
- [ ] **TASK-058**: 实现播放历史记录
  - **预计工时**: 2 天
  - **依赖**: TASK-018, TASK-027
  - **验收标准**:
    - 自动记录播放历史
    - 记录播放时长
    - 完成度统计

- [ ] **TASK-059**: 实现最近播放页面
  - **预计工时**: 1 天
  - **依赖**: TASK-058
  - **验收标准**: 按时间倒序显示

- [ ] **TASK-060**: 实现最常播放页面
  - **预计工时**: 1 天
  - **依赖**: TASK-058
  - **验收标准**: 按播放次数排序

---

### 4.10 搜索功能（第 10 周）

#### 4.10.1 本地搜索 🔴 P0
- [ ] **TASK-061**: 实现搜索服务
  - **预计工时**: 2 天
  - **依赖**: TASK-016
  - **验收标准**:
    - 搜索标题、艺术家、专辑
    - 模糊匹配
    - 结果排序
  - **文件**: `lib/services/search/local_search_service.dart`

- [ ] **TASK-062**: 实现搜索页面
  - **预计工时**: 3 天
  - **依赖**: TASK-061
  - **验收标准**:
    - 搜索框
    - 实时搜索
    - 搜索历史
    - 结果分类显示（歌曲、艺术家、专辑）
  - **文件**: `lib/presentation/pages/search/search_page.dart`

- [ ] **TASK-063**: 实现搜索历史管理
  - **预计工时**: 1 天
  - **依赖**: TASK-062
  - **验收标准**:
    - 保存搜索历史
    - 清除历史
    - 点击历史快速搜索

---

### 4.11 主题和设置（第 10-11 周）

#### 4.11.1 主题切换 🟠 P1
- [ ] **TASK-064**: 实现主题切换功能
  - **预计工时**: 2 天
  - **依赖**: TASK-007, TASK-020
  - **验收标准**:
    - 浅色/深色/跟随系统
    - 平滑过渡动画
    - 设置持久化

- [ ] **TASK-065**: 实现自定义主题色
  - **预计工时**: 2 天
  - **依赖**: TASK-064
  - **验收标准**:
    - 颜色选择器
    - 预览效果
    - 保存自定义主题

#### 4.11.2 设置页面 🟠 P1
- [ ] **TASK-066**: 实现设置页面基础框架
  - **预计工时**: 2 天
  - **依赖**: TASK-020
  - **验收标准**:
    - 分组设置项
    - 统一的设置项样式
  - **文件**: `lib/presentation/pages/settings/settings_page.dart`

- [ ] **TASK-067**: 实现扫描路径设置
  - **预计工时**: 2 天
  - **依赖**: TASK-066
  - **验收标准**:
    - 添加/删除扫描路径
    - 手动触发扫描
    - 显示扫描进度

- [ ] **TASK-068**: 实现播放设置
  - **预计工时**: 1 天
  - **依赖**: TASK-066
  - **验收标准**:
    - 淡入淡出时长
    - 音量正常化开关
    - 播放模式默认值

- [ ] **TASK-069**: 实现动画设置
  - **预计工时**: 1 天
  - **依赖**: TASK-066
  - **验收标准**:
    - 启用/禁用高刷新率
    - 目标帧率选择（60/90/120）
    - 动画速度调节

- [ ] **TASK-070**: 实现缓存管理
  - **预计工时**: 2 天
  - **依赖**: TASK-066
  - **验收标准**:
    - 显示缓存大小
    - 清理缓存
    - 清理封面缓存

---

### 4.12 高级动画（第 11-12 周）

#### 4.12.1 列表动画 🟠 P1
- [ ] **TASK-071**: 实现列表项进入动画
  - **预计工时**: 2 天
  - **依赖**: TASK-045
  - **验收标准**:
    - 交错动画
    - 淡入 + 滑动
    - 120fps 流畅

- [ ] **TASK-072**: 实现列表项删除动画
  - **预计工时**: 1 天
  - **依赖**: TASK-071
  - **验收标准**: 滑出 + 淡出动画

- [ ] **TASK-073**: 实现列表拖拽排序动画
  - **预计工时**: 3 天
  - **依赖**: TASK-048
  - **验收标准**:
    - 长按触发拖拽
    - 拖拽跟手
    - 其他项自动让位

#### 4.12.2 播放器动画 🟠 P1
- [ ] **TASK-074**: 实现播放按钮动画
  - **预计工时**: 1 天
  - **依赖**: TASK-039
  - **验收标准**:
    - 播放/暂停图标过渡
    - AnimatedIcon

- [ ] **TASK-075**: 实现专辑封面旋转动画
  - **预计工时**: 2 天
  - **依赖**: TASK-039
  - **验收标准**:
    - 播放时旋转
    - 暂停时停止
    - 120fps 流畅旋转

- [ ] **TASK-076**: 实现切歌过渡动画
  - **预计工时**: 2 天
  - **依赖**: TASK-075
  - **验收标准**:
    - 封面切换动画
    - 信息淡入淡出
    - 进度条重置动画

#### 4.12.3 微交互动画 🟡 P2
- [ ] **TASK-077**: 实现按钮点击反馈
  - **预计工时**: 1 天
  - **依赖**: TASK-043
  - **验收标准**:
    - 波纹效果
    - 缩放反馈
    - 触觉反馈

- [ ] **TASK-078**: 实现收藏动画
  - **预计工时**: 1 天
  - **依赖**: TASK-056
  - **验收标准**:
    - 心形填充动画
    - 弹性效果

---

### ✅ 阶段二验收标准

- [ ] 播放列表完整功能可用
- [ ] 支持按艺术家、专辑、文件夹分类浏览
- [ ] 收藏和历史功能正常
- [ ] 本地搜索功能完善
- [ ] 主题切换流畅
- [ ] 设置页面功能齐全
- [ ] 所有动画 120fps 流畅

---

## 阶段三：在线功能（6-8 周）

### 📋 里程碑目标
实现在线音乐搜索、播放、下载和歌词功能

---

### 4.13 网络层搭建（第 13 周）

#### 4.13.1 网络配置 🔴 P0
- [ ] **TASK-079**: 实现 Dio 客户端配置
  - **预计工时**: 1 天
  - **依赖**: TASK-005
  - **验收标准**:
    - 超时配置
    - 拦截器
    - 错误处理
  - **文件**: `lib/services/network/dio_client.dart`

- [ ] **TASK-080**: 实现请求日志拦截器
  - **预计工时**: 0.5 天
  - **依赖**: TASK-079
  - **验收标准**: 打印请求和响应日志

- [ ] **TASK-081**: 实现缓存拦截器
  - **预计工时**: 1 天
  - **依赖**: TASK-079
  - **验收标准**:
    - HTTP 缓存
    - 缓存策略配置

- [ ] **TASK-082**: 实现重试拦截器
  - **预计工时**: 1 天
  - **依赖**: TASK-079
  - **验收标准**:
    - 自动重试
    - 指数退避

---

### 4.14 在线音乐搜索（第 14-15 周）

#### 4.14.1 音乐平台 API 🔴 P0
- [ ] **TASK-083**: 实现网易云音乐 API
  - **预计工时**: 3 天
  - **依赖**: TASK-079
  - **验收标准**:
    - 搜索接口
    - 歌曲详情接口
    - 播放地址接口
    - 歌词接口
  - **文件**: `lib/data/datasources/remote/netease_music_api.dart`

- [ ] **TASK-084**: 实现 QQ 音乐 API
  - **预计工时**: 3 天
  - **依赖**: TASK-083
  - **文件**: `lib/data/datasources/remote/qq_music_api.dart`

- [ ] **TASK-085**: 实现酷狗音乐 API
  - **预计工时**: 3 天
  - **依赖**: TASK-083
  - **文件**: `lib/data/datasources/remote/kugou_music_api.dart`

#### 4.14.2 多平台搜索服务 🔴 P0
- [ ] **TASK-086**: 实现多平台搜索聚合
  - **预计工时**: 3 天
  - **依赖**: TASK-083, TASK-084, TASK-085
  - **验收标准**:
    - 并发搜索多个平台
    - 结果去重
    - 结果合并排序
  - **文件**: `lib/services/online/multi_platform_search_service.dart`

- [ ] **TASK-087**: 实现在线搜索页面
  - **预计工时**: 3 天
  - **依赖**: TASK-086
  - **验收标准**:
    - 搜索框
    - 平台筛选
    - 结果列表
    - 加载状态
    - 分页加载
  - **文件**: `lib/presentation/pages/online/online_search_page.dart`

---

### 4.15 在线播放（第 15-16 周）

#### 4.15.1 在线播放服务 🔴 P0
- [x] **TASK-088**: 实现在线歌曲 URL 获取 ✅
  - **预计工时**: 2 天
  - **依赖**: TASK-083
  - **验收标准**:
    - ✅ 获取播放地址
    - ✅ 多音质支持
    - ✅ URL 有效期处理
  - **实现文件**: `lib/services/online/online_play_service.dart`

- [x] **TASK-089**: 集成在线播放到播放器 ✅
  - **预计工时**: 3 天
  - **依赖**: TASK-088, TASK-025
  - **验收标准**:
    - ✅ 在线歌曲播放
    - ✅ 与本地播放无缝切换
    - ✅ 混合播放队列（本地+在线）
  - **实现文件**: `lib/services/audio/online_audio_player_service.dart`

- [x] **TASK-090**: 实现播放缓存 ✅
  - **预计工时**: 2 天
  - **依赖**: TASK-089
  - **验收标准**:
    - ✅ 自动缓存播放的在线歌曲
    - ✅ LRU 缓存策略
    - ✅ 缓存大小限制
  - **实现文件**: `lib/services/online/play_cache_service.dart`

---

### 4.16 音乐下载（第 16-17 周）

#### 4.16.1 下载管理器 🔴 P0
- [ ] **TASK-091**: 实现下载队列管理
  - **预计工时**: 3 天
  - **依赖**: TASK-079
  - **验收标准**:
    - 添加到下载队列
    - 并发下载限制
    - 队列持久化
  - **文件**: `lib/services/download/download_manager.dart`

- [ ] **TASK-092**: 实现下载进度跟踪
  - **预计工时**: 2 天
  - **依赖**: TASK-091
  - **验收标准**:
    - 实时进度更新
    - 下载速度显示
    - 剩余时间估算

- [ ] **TASK-093**: 实现断点续传
  - **预计工时**: 3 天
  - **依赖**: TASK-092
  - **验收标准**:
    - 支持暂停/恢复
    - Range 请求头
    - 断点信息保存

- [ ] **TASK-094**: 实现下载完成处理
  - **预计工时**: 2 天
  - **依赖**: TASK-093
  - **验收标准**:
    - 自动添加到本地库
    - 写入元数据
    - 保存封面图片

#### 4.16.2 下载 UI 🟠 P1
- [ ] **TASK-095**: 实现下载页面
  - **预计工时**: 3 天
  - **依赖**: TASK-091
  - **验收标准**:
    - 下载队列列表
    - 进度条显示
    - 状态显示（下载中、暂停、完成、失败）
  - **文件**: `lib/presentation/pages/download/download_page.dart`

- [ ] **TASK-096**: 实现下载控制
  - **预计工时**: 2 天
  - **依赖**: TASK-095
  - **验收标准**:
    - 暂停/恢复按钮
    - 取消下载
    - 全部开始/暂停
    - 清除已完成

#### 4.16.3 音质选择 🟠 P1
- [ ] **TASK-097**: 实现音质选择器
  - **预计工时**: 2 天
  - **依赖**: TASK-088
  - **验收标准**:
    - 标准/高品质/无损
    - 文件大小显示
    - 默认音质设置

---

### 4.17 歌词功能（第 17-18 周）

#### 4.17.1 歌词服务 🔴 P0
- [ ] **TASK-098**: 实现在线歌词获取
  - **预计工时**: 2 天
  - **依赖**: TASK-083
  - **验收标准**:
    - 获取 LRC 歌词
    - 获取翻译歌词
    - 缓存歌词
  - **文件**: `lib/services/lyrics/lyrics_service.dart`

- [ ] **TASK-099**: 实现本地歌词读取
  - **预计工时**: 1 天
  - **依赖**: TASK-098
  - **验收标准**:
    - 读取 .lrc 文件
    - 自动匹配同名歌词

- [ ] **TASK-100**: 实现 LRC 歌词解析
  - **预计工时**: 2 天
  - **依赖**: TASK-098
  - **验收标准**:
    - 解析时间标签
    - 解析歌词文本
    - 处理增强 LRC 格式
  - **文件**: `lib/services/lyrics/lrc_parser.dart`

#### 4.17.2 歌词显示 🔴 P0
- [ ] **TASK-101**: 实现歌词控制器
  - **预计工时**: 2 天
  - **依赖**: TASK-100
  - **验收标准**:
    - 根据播放位置定位歌词行
    - 歌词行变化通知
  - **文件**: `lib/presentation/controllers/lyrics_controller.dart`

- [ ] **TASK-102**: 实现歌词显示组件
  - **预计工时**: 3 天
  - **依赖**: TASK-101
  - **验收标准**:
    - 逐行显示
    - 当前行高亮
    - 自动滚动
    - 翻译显示
  - **文件**: `lib/presentation/widgets/lyrics_view.dart`

- [ ] **TASK-103**: 实现歌词滚动动画
  - **预计工时**: 2 天
  - **依赖**: TASK-102
  - **验收标准**:
    - 平滑滚动
    - 120fps 流畅
    - 文字大小/颜色渐变

- [ ] **TASK-104**: 实现歌词手动滚动
  - **预计工时**: 2 天
  - **依赖**: TASK-103
  - **验收标准**:
    - 支持手动滚动
    - 点击歌词行跳转播放位置
    - 自动回到当前行

#### 4.17.3 桌面歌词（Windows）🟡 P2
- [ ] **TASK-105**: 实现桌面歌词窗口
  - **预计工时**: 3 天
  - **依赖**: TASK-102
  - **验收标准**:
    - 独立悬浮窗口
    - 置顶显示
    - 透明背景
    - 可拖动
  - **平台**: Windows only

- [ ] **TASK-106**: 实现桌面歌词设置
  - **预计工时**: 2 天
  - **依赖**: TASK-105
  - **验收标准**:
    - 字体大小/颜色
    - 透明度
    - 锁定位置

#### 4.17.4 锁屏歌词（Android）🟡 P2
- [ ] **TASK-107**: 实现锁屏歌词
  - **预计工时**: 3 天
  - **依赖**: TASK-102
  - **验收标准**:
    - 锁屏界面显示歌词
    - 跟随播放进度
  - **平台**: Android only

---

### 4.18 播放器详情页（第 18-19 周）

#### 4.18.1 播放器全屏页面 🟠 P1
- [ ] **TASK-108**: 实现播放器全屏页面
  - **预计工时**: 4 天
  - **依赖**: TASK-039, TASK-102
  - **验收标准**:
    - 大尺寸专辑封面
    - 歌曲信息
    - 完整控制面板
    - 播放队列
    - 歌词显示
  - **文件**: `lib/presentation/pages/player/player_page.dart`

- [ ] **TASK-109**: 实现播放器页面动画
  - **预计工时**: 3 天
  - **依赖**: TASK-108
  - **验收标准**:
    - 从底部栏展开动画
    - Hero 动画（封面）
    - 共享元素过渡

- [ ] **TASK-110**: 实现播放队列抽屉
  - **预计工时**: 2 天
  - **依赖**: TASK-108
  - **验收标准**:
    - 显示播放队列
    - 拖拽排序
    - 删除歌曲
    - 清空队列

---

### ✅ 阶段三验收标准

- [ ] 在线搜索功能正常
- [ ] 在线音乐可播放
- [ ] 下载功能完善（断点续传）
- [ ] 歌词显示正常
- [ ] 桌面歌词（Windows）可用
- [ ] 锁屏歌词（Android）可用
- [ ] 播放器全屏页面完整

---

## 阶段四：优化和平台特性（4-6 周）

### 📋 里程碑目标
实现平台特定功能，优化性能和体验

---

### 4.19 Windows 平台特性（第 20-21 周）

#### 4.19.1 系统托盘 🔴 P0
- [ ] **TASK-111**: 实现系统托盘图标
  - **预计工时**: 2 天
  - **依赖**: 无
  - **验收标准**:
    - 托盘图标显示
    - 鼠标悬停提示
    - 右键菜单
  - **平台**: Windows only

- [ ] **TASK-112**: 实现托盘菜单
  - **预计工时**: 1 天
  - **依赖**: TASK-111
  - **验收标准**:
    - 播放/暂停
    - 上一曲/下一曲
    - 显示主窗口
    - 退出应用

- [ ] **TASK-113**: 实现最小化到托盘
  - **预计工时**: 1 天
  - **依赖**: TASK-111
  - **验收标准**:
    - 点击关闭按钮最小化到托盘
    - 托盘图标双击显示窗口

#### 4.19.2 全局快捷键 🟠 P1
- [ ] **TASK-114**: 实现全局快捷键注册
  - **预计工时**: 2 天
  - **依赖**: 无
  - **验收标准**:
    - Ctrl+Space: 播放/暂停
    - Ctrl+Right: 下一曲
    - Ctrl+Left: 上一曲
  - **平台**: Windows only

- [ ] **TASK-115**: 实现快捷键设置
  - **预计工时**: 2 天
  - **依赖**: TASK-114
  - **验收标准**:
    - 自定义快捷键
    - 快捷键冲突检测

#### 4.19.3 其他 Windows 特性 🟡 P2
- [ ] **TASK-116**: 实现媒体键支持
  - **预计工时**: 1 天
  - **依赖**: TASK-027
  - **验收标准**:
    - 响应键盘媒体键
    - 播放/暂停、上一曲、下一曲
  - **平台**: Windows only

- [ ] **TASK-117**: 实现任务栏集成
  - **预计工时**: 2 天
  - **依赖**: TASK-027
  - **验收标准**:
    - 任务栏缩略图工具栏
    - 显示播放状态
  - **平台**: Windows only

- [ ] **TASK-118**: 实现高刷新率显示器检测
  - **预计工时**: 2 天
  - **依赖**: TASK-043
  - **验收标准**:
    - 检测显示器刷新率
    - 自动适配 120/144/165Hz
  - **平台**: Windows only

---

### 4.20 Android 平台特性（第 21-22 周）

#### 4.20.1 后台播放服务 🔴 P0
- [ ] **TASK-119**: 实现前台服务
  - **预计工时**: 3 天
  - **依赖**: TASK-027
  - **验收标准**:
    - 后台持续播放
    - 前台服务通知
    - 防止被系统杀死
  - **平台**: Android only

- [ ] **TASK-120**: 实现 AudioHandler
  - **预计工时**: 2 天
  - **依赖**: TASK-119
  - **验收标准**:
    - 媒体会话管理
    - 播放状态同步
  - **平台**: Android only

#### 4.20.2 通知栏控制 🔴 P0
- [ ] **TASK-121**: 实现媒体通知
  - **预计工时**: 3 天
  - **依赖**: TASK-120
  - **验收标准**:
    - 显示歌曲信息
    - 显示封面
    - 播放控制按钮
    - 进度条（Android 13+）
  - **平台**: Android only

- [ ] **TASK-122**: 实现通知样式
  - **预计工时**: 2 天
  - **依赖**: TASK-121
  - **验收标准**:
    - MediaStyle 通知
    - 自定义布局
  - **平台**: Android only

#### 4.20.3 锁屏控制 🟠 P1
- [ ] **TASK-123**: 实现锁屏播放控制
  - **预计工时**: 2 天
  - **依赖**: TASK-121
  - **验收标准**:
    - 锁屏界面显示控制
    - 封面显示
  - **平台**: Android only

#### 4.20.4 桌面小部件 🟡 P2
- [ ] **TASK-124**: 实现桌面小部件
  - **预计工时**: 4 天
  - **依赖**: TASK-027
  - **验收标准**:
    - 小部件布局
    - 显示当前播放
    - 控制按钮
    - 点击跳转应用
  - **平台**: Android only

#### 4.20.5 其他 Android 特性 🟠 P1
- [ ] **TASK-125**: 实现耳机线控支持
  - **预计工时**: 1 天
  - **依赖**: TASK-120
  - **验收标准**:
    - 响应耳机按钮
    - 播放/暂停、切歌
  - **平台**: Android only

- [ ] **TASK-126**: 实现自动暂停
  - **预计工时**: 2 天
  - **依赖**: TASK-027
  - **验收标准**:
    - 来电时暂停
    - 拔耳机时暂停
    - 通话结束恢复播放
  - **平台**: Android only

- [ ] **TASK-127**: 实现高刷新率屏幕优化
  - **预计工时**: 2 天
  - **依赖**: TASK-043
  - **验收标准**:
    - 检测屏幕刷新率
    - 自动适配 90/120/144Hz
  - **平台**: Android only

---

### 4.21 数据同步（第 22-23 周）

#### 4.21.1 本地数据导出/导入 🟠 P1
- [ ] **TASK-128**: 实现数据备份
  - **预计工时**: 3 天
  - **依赖**: TASK-010
  - **验收标准**:
    - 导出数据库
    - 导出设置
    - 导出播放列表
    - 压缩为备份文件

- [ ] **TASK-129**: 实现数据恢复
  - **预计工时**: 3 天
  - **依赖**: TASK-128
  - **验收标准**:
    - 导入备份文件
    - 数据合并策略
    - 冲突处理

#### 4.21.2 云端同步（可选）🟢 P3
- [ ] **TASK-130**: 设计同步协议
  - **预计工时**: 2 天
  - **依赖**: 无
  - **验收标准**: 同步数据格式定义

- [ ] **TASK-131**: 实现同步服务
  - **预计工时**: 5 天
  - **依赖**: TASK-130
  - **验收标准**:
    - 增量同步
    - 冲突解决
    - 双向同步

---

### 4.22 性能优化（第 23-24 周）

#### 4.22.1 启动优化 🟠 P1
- [ ] **TASK-132**: 实现启动时间分析
  - **预计工时**: 1 天
  - **依赖**: 无
  - **验收标准**: 统计各阶段耗时

- [ ] **TASK-133**: 延迟非关键初始化
  - **预计工时**: 2 天
  - **依赖**: TASK-132
  - **验收标准**:
    - 首屏快速显示
    - 后台初始化非关键服务

- [ ] **TASK-134**: 优化数据库初始化
  - **预计工时**: 2 天
  - **依赖**: TASK-132
  - **验收标准**:
    - 延迟加载歌曲列表
    - 分批加载数据

#### 4.22.2 内存优化 🟠 P1
- [ ] **TASK-135**: 配置图片缓存
  - **预计工时**: 1 天
  - **依赖**: 无
  - **验收标准**:
    - 限制缓存大小
    - LRU 策略

- [ ] **TASK-136**: 优化列表性能
  - **预计工时**: 2 天
  - **依赖**: TASK-037
  - **验收标准**:
    - 使用 AutomaticKeepAlive
    - 合理的 cacheExtent
    - 避免不必要的重建

- [ ] **TASK-137**: 实现内存监控
  - **预计工时**: 2 天
  - **依赖**: 无
  - **验收标准**:
    - 监控内存占用
    - 内存泄漏检测

#### 4.22.3 动画性能优化 🔴 P0
- [ ] **TASK-138**: 实现 FPS 监控
  - **预计工时**: 2 天
  - **依赖**: TASK-043
  - **验收标准**:
    - 实时 FPS 显示（Debug）
    - 帧率统计
  - **文件**: `lib/core/performance/fps_monitor.dart`

- [ ] **TASK-139**: 实现性能自适应
  - **预计工时**: 3 天
  - **依赖**: TASK-138
  - **验收标准**:
    - 检测帧率下降
    - 自动降级动画质量
    - 目标帧率动态调整

- [ ] **TASK-140**: 优化重绘区域
  - **预计工时**: 2 天
  - **依赖**: 无
  - **验收标准**:
    - 添加 RepaintBoundary
    - 隔离动画区域
    - 减少不必要的重绘

#### 4.22.4 网络优化 🟡 P2
- [ ] **TASK-141**: 实现请求队列
  - **预计工时**: 2 天
  - **依赖**: TASK-079
  - **验收标准**:
    - 限制并发请求数
    - 请求优先级

- [ ] **TASK-142**: 优化图片加载
  - **预计工时**: 2 天
  - **依赖**: 无
  - **验收标准**:
    - 渐进式加载
    - 缩略图预加载
    - WebP 格式支持

---

### ✅ 阶段四验收标准

- [ ] Windows 系统托盘功能完整
- [ ] Windows 全局快捷键可用
- [ ] Android 后台播放稳定
- [ ] Android 通知栏控制正常
- [ ] 数据备份/恢复功能可用
- [ ] 应用启动时间 < 3 秒
- [ ] 动画帧率稳定 120fps
- [ ] 内存占用符合要求

---

## 阶段五：测试和发布（2-4 周）

### 📋 里程碑目标
全面测试、修复 Bug、准备发布

---

### 4.23 测试（第 25-26 周）

#### 4.23.1 单元测试 🔴 P0
- [ ] **TASK-143**: 编写核心服务单元测试
  - **预计工时**: 5 天
  - **依赖**: 所有核心模块
  - **验收标准**:
    - AudioPlayerService 测试
    - MusicScanner 测试
    - LyricsParser 测试
    - 测试覆盖率 > 70%

- [ ] **TASK-144**: 编写数据层单元测试
  - **预计工时**: 3 天
  - **依赖**: TASK-143
  - **验收标准**:
    - Repository 测试
    - DAO 测试
    - Model 测试

#### 4.23.2 Widget 测试 🟠 P1
- [ ] **TASK-145**: 编写 Widget 测试
  - **预计工时**: 3 天
  - **依赖**: TASK-143
  - **验收标准**:
    - 主要页面测试
    - 关键组件测试
    - 交互测试

#### 4.23.3 集成测试 🟠 P1
- [ ] **TASK-146**: 编写端到端测试
  - **预计工时**: 5 天
  - **依赖**: TASK-145
  - **验收标准**:
    - 完整播放流程测试
    - 搜索和下载流程测试
    - 播放列表操作测试

#### 4.23.4 性能测试 🔴 P0
- [ ] **TASK-147**: 进行性能基准测试
  - **预计工时**: 3 天
  - **依赖**: TASK-138
  - **验收标准**:
    - 启动时间测试
    - 内存占用测试
    - 帧率测试
    - 大数据量测试（10000+ 歌曲）

- [ ] **TASK-148**: 进行动画流畅度测试
  - **预计工时**: 2 天
  - **依赖**: TASK-147
  - **验收标准**:
    - 所有动画 120fps 验证
    - 不同设备测试
    - 性能降级测试

#### 4.23.5 兼容性测试 🟠 P1
- [ ] **TASK-149**: Windows 平台测试
  - **预计工时**: 2 天
  - **依赖**: 无
  - **验收标准**:
    - Windows 10 测试
    - Windows 11 测试
    - 不同分辨率测试
    - 高刷显示器测试

- [ ] **TASK-150**: Android 平台测试
  - **预计工时**: 3 天
  - **依赖**: 无
  - **验收标准**:
    - Android 8-14 测试
    - 不同品牌手机测试
    - 高刷屏幕测试
    - 平板设备测试

---

### 4.24 Bug 修复（第 26-27 周）

#### 4.24.1 Bug 修复 🔴 P0
- [ ] **TASK-151**: 修复测试发现的 Bug
  - **预计工时**: 10 天
  - **依赖**: 所有测试任务
  - **验收标准**: 所有 P0/P1 级别 Bug 修复

#### 4.24.2 用户体验优化 🟠 P1
- [ ] **TASK-152**: 优化 UI 细节
  - **预计工时**: 3 天
  - **依赖**: TASK-151
  - **验收标准**:
    - 间距、对齐调整
    - 颜色和对比度优化
    - 图标统一

- [ ] **TASK-153**: 优化交互反馈
  - **预计工时**: 2 天
  - **依赖**: TASK-152
  - **验收标准**:
    - 所有按钮有反馈
    - 加载状态明确
    - 错误提示友好

---

### 4.25 文档和发布准备（第 27-28 周）

#### 4.25.1 文档编写 🟠 P1
- [ ] **TASK-154**: 编写用户手册
  - **预计工时**: 3 天
  - **依赖**: 无
  - **验收标准**:
    - 安装说明
    - 功能介绍
    - 常见问题

- [ ] **TASK-155**: 编写开发文档
  - **预计工时**: 2 天
  - **依赖**: 无
  - **验收标准**:
    - 项目结构说明
    - 开发环境搭建
    - 贡献指南

- [ ] **TASK-156**: 编写 API 文档
  - **预计工时**: 2 天
  - **依赖**: 无
  - **验收标准**: 主要接口和用法说明

#### 4.25.2 发布准备 🔴 P0
- [ ] **TASK-157**: 配置应用签名（Android）
  - **预计工时**: 0.5 天
  - **依赖**: 无
  - **验收标准**:
    - 生成签名密钥
    - 配置 build.gradle
  - **平台**: Android only

- [ ] **TASK-158**: 配置应用图标和启动画面
  - **预计工时**: 1 天
  - **依赖**: 无
  - **验收标准**:
    - 设计应用图标
    - 配置自适应图标（Android）
    - 启动画面

- [ ] **TASK-159**: 配置版本号和构建信息
  - **预计工时**: 0.5 天
  - **依赖**: 无
  - **验收标准**:
    - 版本号规范
    - 构建编号自动递增

- [ ] **TASK-160**: 构建发布版本
  - **预计工时**: 1 天
  - **依赖**: TASK-157, TASK-158, TASK-159
  - **验收标准**:
    - Windows 安装包（.exe）
    - Android APK/AAB
    - 代码混淆
    - 体积优化

#### 4.25.3 发布 🔴 P0
- [ ] **TASK-161**: 创建 GitHub Release
  - **预计工时**: 0.5 天
  - **依赖**: TASK-160
  - **验收标准**:
    - 上传发布包
    - 编写 Release Notes
    - 标签版本

- [ ] **TASK-162**: 发布到应用商店（可选）
  - **预计工时**: 2 天
  - **依赖**: TASK-160
  - **验收标准**:
    - Google Play 提交（Android）
    - Microsoft Store 提交（Windows）
    - 应用描述和截图

---

### ✅ 阶段五验收标准

- [ ] 所有关键功能测试通过
- [ ] P0/P1 级别 Bug 全部修复
- [ ] 性能指标达标
- [ ] 文档完善
- [ ] 发布包生成成功
- [ ] 应用商店提交成功（可选）

---

## 5. 里程碑计划

| 里程碑 | 时间节点 | 交付物 | 状态 |
|--------|----------|--------|------|
| M1: 项目启动 | 第 1 周 | 项目环境搭建完成 | ⏳ 待开始 |
| M2: MVP 完成 | 第 6 周 | 基础播放功能可用 | ⏳ 待开始 |
| M3: 核心功能完成 | 第 12 周 | 本地音乐管理完善 | ⏳ 待开始 |
| M4: 在线功能完成 | 第 19 周 | 在线搜索、下载、歌词可用 | ⏳ 待开始 |
| M5: 平台特性完成 | 第 24 周 | 双平台特性实现 | ⏳ 待开始 |
| M6: Beta 发布 | 第 26 周 | Beta 版本发布 | ⏳ 待开始 |
| M7: 正式发布 | 第 28 周 | v1.0 正式版发布 | ⏳ 待开始 |

---

## 6. 风险管理

### 6.1 技术风险

| 风险 | 影响 | 概率 | 应对策略 |
|------|------|------|----------|
| 120fps 性能无法达标 | 高 | 中 | 1. 提前进行性能测试<br>2. 准备降级方案<br>3. 优化关键动画 |
| 跨平台兼容性问题 | 高 | 中 | 1. 早期在双平台测试<br>2. 使用平台抽象层<br>3. 关键功能提供后备方案 |
| 音频播放稳定性 | 高 | 低 | 1. 使用成熟的 just_audio<br>2. 充分的错误处理<br>3. 用户反馈收集 |
| 在线 API 失效 | 中 | 中 | 1. 多平台冗余<br>2. API 监控<br>3. 降级到本地功能 |
| 数据库性能瓶颈 | 中 | 低 | 1. 索引优化<br>2. 分页查询<br>3. 缓存策略 |

### 6.2 进度风险

| 风险 | 影响 | 概率 | 应对策略 |
|------|------|------|----------|
| 任务预估不准确 | 中 | 高 | 1. 预留 buffer 时间<br>2. 敏捷迭代<br>3. 及时调整计划 |
| 功能蔓延 | 中 | 中 | 1. 严格需求管理<br>2. MVP 优先<br>3. 新功能放入下版本 |
| 人员不足 | 高 | 低 | 1. 合理任务分配<br>2. 降低优先级任务<br>3. 外部协作 |

### 6.3 法律风险

| 风险 | 影响 | 概率 | 应对策略 |
|------|------|------|----------|
| 在线音乐版权问题 | 高 | 中 | 1. 仅提供搜索链接<br>2. 不存储版权内容<br>3. 法律咨询 |
| 第三方 API 使用限制 | 中 | 中 | 1. 研读使用条款<br>2. 用户量限制<br>3. 备用方案 |

---

## 7. 资源分配

### 7.1 人员配置建议

#### 小团队配置（2-3 人）
- **全栈开发** x 2-3
  - 负责所有开发任务
  - 跨平台开发经验
  - Flutter 熟练

#### 标准团队配置（5-6 人）
- **项目经理** x 1: 项目管理、需求协调
- **前端开发（Flutter）** x 2: UI/UX 实现、动画
- **后端开发** x 1: 在线服务、API 对接
- **测试工程师** x 1: 测试、质量保证
- **UI/UX 设计师** x 1: 界面设计、交互设计

### 7.2 开发设备要求

#### Windows 开发机
- **CPU**: Intel i7 / AMD Ryzen 7 或更高
- **内存**: 16GB+
- **显示器**: 支持 120Hz+ 刷新率（用于测试）
- **系统**: Windows 10/11

#### Android 测试设备
- **高端设备**: 120Hz 屏幕，用于性能测试
- **中端设备**: 60-90Hz 屏幕
- **低端设备**: 60Hz 屏幕，用于兼容性测试
- **系统版本**: Android 8.0 - 14

---

## 8. 任务跟踪

### 8.1 任务状态

- ⏳ **待开始** (To Do)
- 🟡 **进行中** (In Progress)
- ⏸️ **暂停** (Paused)
- ✅ **已完成** (Done)
- ❌ **已取消** (Cancelled)

### 8.2 优先级统计

| 优先级 | 任务数 | 预计总工时 |
|--------|--------|------------|
| P0 🔴 | 54 | ~170 天 |
| P1 🟠 | 42 | ~90 天 |
| P2 🟡 | 18 | ~35 天 |
| P3 🟢 | 2 | ~7 天 |
| **合计** | **116** | **~302 天** |

### 8.3 任务依赖关系

使用 Gantt 图或项目管理工具（如 Jira、Trello、GitHub Projects）跟踪任务依赖和进度。

---

## 9. 质量标准

### 9.1 代码质量

- [ ] 遵循 Dart 代码规范
- [ ] 通过 `dart analyze` 无错误
- [ ] 通过 `flutter analyze` 无错误
- [ ] 代码审查通过
- [ ] 单元测试覆盖率 > 70%

### 9.2 性能标准

- [ ] 应用启动时间 < 3 秒
- [ ] 动画帧率 ≥ 120 FPS（高刷设备）
- [ ] 内存占用 < 200MB（Windows）/ < 150MB（Android）
- [ ] 大数据量（10000+ 歌曲）流畅运行

### 9.3 用户体验标准

- [ ] 所有交互有反馈
- [ ] 错误提示清晰友好
- [ ] 加载状态明确
- [ ] 无明显 Bug
- [ ] 界面美观统一

---

## 10. 发布计划

### 10.1 版本规划

#### v1.0.0 - 正式版（第 28 周）
- 所有核心功能
- Windows + Android 支持
- 120fps 动画
- 在线搜索和下载
- 歌词功能

#### v1.1.0 - 功能增强（v1.0 后 2-3 月）
- 均衡器
- 播客支持
- 社交功能（分享）
- 智能推荐

#### v1.2.0 - 跨平台扩展（v1.1 后 3-4 月）
- iOS 支持
- macOS 支持
- Web 版本

---

## 附录

### A. 任务模板

```markdown
## TASK-XXX: 任务名称

**优先级**: P0/P1/P2/P3
**预计工时**: X 天
**负责人**: 待分配
**依赖**: TASK-XXX, TASK-XXX
**平台**: All / Windows / Android

### 描述
详细描述任务内容...

### 验收标准
- [ ] 标准 1
- [ ] 标准 2
- [ ] 标准 3

### 实现要点
- 要点 1
- 要点 2

### 测试要点
- 测试项 1
- 测试项 2

### 相关文件
- `lib/path/to/file.dart`
```

### B. 相关文档

- [需求文档](./requirements.md)
- [设计文档](./design.md)
- [开发规范](./development-guide.md)（待创建）
- [测试计划](./test-plan.md)（待创建）

### C. 工具推荐

- **项目管理**: GitHub Projects / Jira / Trello
- **代码版本控制**: Git / GitHub
- **CI/CD**: GitHub Actions / GitLab CI
- **性能分析**: Flutter DevTools
- **设计协作**: Figma
- **文档**: Markdown / Notion

---

## 更新日志

- **2026-01-20**: 初始版本任务文档创建
  - 定义 116 个详细任务
  - 5 个开发阶段规划
  - 7 个里程碑节点
  - 风险管理和资源分配
